{% extends 'admin.html.twig' %}

{% block admin %}
	<div class="d-flex justify-content-between align-items-center">
		<h1>Invités</h1>
		<a href="{{ path('admin_guest_add') }}" class="btn btn-primary">Ajouter</a>
	</div>
	{% for guest in guests %}
		<div class="card mb-3">
			<div class="card-body d-flex justify-content-between align-items-center">
				<div class="guest-info">
					<strong>{{ guest.name }}</strong>
					-
					{{ guest.email }}
					{% if guest.description %}
						<p class="mb-0">{{ guest.description }}</p>
					{% endif %}
					<small>
						Statut :
						{% if guest.isActive %}
							<span class="badge bg-success">Actif</span>
						{% else %}
							<span class="badge bg-secondary">Désactivé</span>
						{% endif %}
					</small>
				</div>
				<div class="guest-actions d-flex gap-2">

					{% if is_granted('ROLE_ADMIN') %}
						<form action="{{ path('admin_guests_toggle', {id: guest.id}) }}" method="POST" style="display:inline;">
							<button class="btn btn-sm btn-info">
								{% if guest.isActive %}Désactiver{% else %}Activer
								{% endif %}
							</button>
						</form>
					{% endif %}
					<form action="{{ path('admin_guest_delete', {id: guest.id}) }}" method="POST" style="display:inline;" onsubmit="return confirm('Voulez-vous vraiment supprimer cet invité ?')">
						<button class="btn btn-sm btn-danger">Supprimer</button>
					</form>
				</div>
			</div>
		</div>
	{% else %}
		<p>Aucun invité trouvé.</p>
		{% set totalPages = (total / 50)|round(0, 'ceil') %}
	{% endfor %}
	<nav aria-label="Page navigation">
		<ul class="pagination">
			{% if page > 1 %}
				<li class="page-item">
					<a class="page-link" href="{{ path('admin_guest_index', {page: 1}) }}">Première page</a>
				</li>
				<li class="page-item">
					<a class="page-link" href="{{ path('admin_guest_index', {page: page - 1}) }}">Précédent</a>
				</li>
			{% endif %}

			{% for i in range(max(1, page - 3), min(totalPages, page + 3)) %}
				<li class="page-item {% if i == page %}active{% endif %}">
					<a class="page-link" href="{{ path('admin_guest_index', {page: i}) }}">{{ i }}</a>
				</li>
			{% endfor %}

			{% if page < totalPages %}
				<li class="page-item">
					<a class="page-link" href="{{ path('admin_guest_index', {page: page + 1}) }}">Suivant</a>
				</li>
				<li class="page-item">
					<a class="page-link" href="{{ path('admin_guest_index', {page: totalPages}) }}">Dernière page</a>
				</li>
			{% endif %}
		</ul>
	</nav>
{% endblock %}
